{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from \"react\";\nimport Link from \"next/link\";\nimport router from \"next/router\";\nimport { isAuth, getCookie } from \"../../actions/auth\";\nimport { list, removeBlog } from \"../../actions/blog\";\nimport moment from \"moment\";\n\nvar BlogRead = function BlogRead(_ref) {\n  var username = _ref.username;\n\n  var _useState = useState([]),\n      blogs = _useState[0],\n      setBlogs = _useState[1];\n\n  var _useState2 = useState(''),\n      message = _useState2[0],\n      setMessage = _useState2[1];\n\n  var token = getCookie(\"token\");\n\n  var loadBlogs = function loadBlogs() {\n    list(username).then(function (data) {\n      if (data.error || undefined) {\n        console.log(data.error);\n      } else {\n        setBlogs(data);\n      }\n    });\n  };\n\n  useEffect(function () {\n    loadBlogs();\n  }, []);\n\n  var deleteBlog = function deleteBlog(slug) {\n    removeBlog(slug, token).then(function (data) {\n      if (data.error) {\n        console.log(data.error);\n      } else {\n        setMessage(data.message);\n        loadBlogs();\n      }\n    });\n  };\n\n  var deleteConfirm = function deleteConfirm(slug) {\n    var answer = window.confirm(\"Are you sure you want to delete blog?\");\n\n    if (answer) {\n      deleteBlog(slug);\n    }\n  };\n\n  var showUpdateButton = function showUpdateButton(blog) {\n    if (isAuth() && isAuth.role === 0) {\n      return /*#__PURE__*/_jsx(Link, {\n        href: \"/admin/crud/\".concat(blog.slug),\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: \"ml-2 btn btn-sm btn-warning\",\n          children: \"Update\"\n        })\n      });\n    } else {\n      return /*#__PURE__*/_jsx(Link, {\n        href: \"/user/crud/\".concat(blog.slug),\n        children: /*#__PURE__*/_jsx(\"a\", {\n          className: \"btn btn-sm btn-warning\",\n          children: \"Update\"\n        })\n      });\n    }\n  };\n\n  var showAllBlogs = function showAllBlogs() {\n    return blogs.map(function (blog, i) {\n      return /*#__PURE__*/_jsxs(\"div\", {\n        className: \"pb-5\",\n        children: [/*#__PURE__*/_jsx(\"h3\", {\n          children: blog.title\n        }), /*#__PURE__*/_jsxs(\"p\", {\n          className: \"mark\",\n          children: [\"Written by \", blog.postedBy.name, \" | Published on \", moment(blog.updatedAt).fromNow()]\n        }), /*#__PURE__*/_jsx(\"button\", {\n          className: \"btn btn-sm btn-danger\",\n          onClick: function onClick() {\n            return deleteConfirm(blog.slug);\n          },\n          children: \"Delete\"\n        }), showUpdateButton(blog)]\n      }, i);\n    });\n  };\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsx(\"p\", {\n          children: \"Update/Delete Blogs\"\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"col-md-12\",\n          children: [message && /*#__PURE__*/_jsx(\"div\", {\n            className: \"alert alert-warning\",\n            children: message\n          }), showAllBlogs()]\n        })]\n      })\n    })\n  });\n};\n\nexport default BlogRead;","map":null,"metadata":{},"sourceType":"module"}